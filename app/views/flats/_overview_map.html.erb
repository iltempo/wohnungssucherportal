<div id="map">
  <script type="text/javascript">
  
    function icon(color) {
      var icon = new GIcon(G_DEFAULT_ICON);
      icon.image = "http://www.google.com/intl/en_us/mapfiles/ms/micons/" + color + "-dot.png";
      icon.iconSize = new GSize(34, 34);
      icon.shadow = false;
      return icon;
    }
    
    function initialize() {
      var map = initMap(850, 750);
      var geocoder = new GClientGeocoder();

      // center map somewhere hardcoded
      geocoder.getLatLng('Kleinhesseloher See, MÃ¼nchen', function(latLng) {
        map.setCenter(latLng, 13);
      });

      // add some city reference points
      geocoder.getLatLng("<%= amazon_muenchen %>", function(latLng) {
        var markerOptions = {
          'title': "<%= amazon_muenchen %>",
          'icon': icon('green')
        };
        var marker = new GMarker(latLng, markerOptions);
        map.addOverlay(marker);
      });
        
      // add markers for flats
      G_addresses.each(function(address) {
        console.log(address);
        geocoder.getLatLng(address, function(latLng) {
          var marker = new GMarker(latLng, { 'title': address });
          map.addOverlay(marker);          
        });
      });
    }
    </script>
    
  <body onload="initialize()" onunload="GUnload()">
    <div id="map_canvas" style="width: 800px; height: 600px; border: 1px solid #000"></div>
</div>